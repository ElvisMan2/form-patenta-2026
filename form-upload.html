<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form envio archivos</title>
    
</head>
<body>
    <style>
  .form-concurso {
    font-family: Arial, sans-serif;
    max-width: 600px;
    margin: 0 auto;
    padding: 20px;
  }
  .form-concurso .form-group {
    margin-bottom: 15px;
  }
  .form-concurso label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
    color: #333;
  }
  .form-concurso input,
  .form-concurso select,
  .form-concurso textarea {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
  }
  .form-concurso input[type="file"] {
    padding: 8px;
  }
  .form-concurso .btn-submit {
    background-color: #0073aa;
    color: white;
    padding: 12px 24px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
    width: 100%;
  }
  .form-concurso .btn-submit:hover {
    background-color: #005a87;
  }
  .form-concurso .btn-submit:disabled {
    background-color: #ccc;
    cursor: not-allowed;
  }
  .form-concurso .mensaje {
    padding: 10px;
    margin-top: 15px;
    border-radius: 4px;
    display: none;
  }
  .form-concurso .mensaje.exito {
    background-color: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  }
  .form-concurso .mensaje.error {
    background-color: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  }
  .form-concurso .required::after {
    content: " *";
    color: red;
  }
  .form-concurso .loader {
    display: none;
    text-align: center;
    margin: 10px 0;
  }
</style>

<div class="form-concurso">
  <form id="formConcurso">
    <div class="form-group">
      <label class="required" for="tipoParticipante">Tipo de Participante</label>
      <select id="tipoParticipante" name="tipoParticipante" required>
        <option value="">Seleccione...</option>
        <option value="Persona Natural">Persona Natural</option>
        <option value="Empresa">Empresa</option>
        <option value="Institución">Institución</option>
      </select>
    </div>

    <div class="form-group">
      <label for="nombreInstitucionEmpresa">Nombre de Institución/Empresa</label>
      <input type="text" id="nombreInstitucionEmpresa" name="nombreInstitucionEmpresa">
    </div>

    <div class="form-group">
      <label class="required" for="titulo">Título del Proyecto</label>
      <input type="text" id="titulo" name="titulo" required>
    </div>

    <div class="form-group">
      <label class="required" for="sectorTecnologico">Sector Tecnológico</label>
      <select id="sectorTecnologico" name="sectorTecnologico" required>
        <option value="">Seleccione...</option>
        <option value="Biotecnología">Biotecnología</option>
        <option value="TIC">TIC</option>
        <option value="Energía">Energía</option>
        <option value="Agroindustria">Agroindustria</option>
        <option value="Otro">Otro</option>
      </select>
    </div>

    <div class="form-group">
      <label class="required" for="apellidosRepresentante">Apellidos del Representante</label>
      <input type="text" id="apellidosRepresentante" name="apellidosRepresentante" required>
    </div>

    <div class="form-group">
      <label class="required" for="nombreRepresentante">Nombres del Representante</label>
      <input type="text" id="nombreRepresentante" name="nombreRepresentante" required>
    </div>

    <div class="form-group">
      <label class="required" for="dni">DNI</label>
      <input type="text" id="dni" name="dni" maxlength="8" pattern="[0-9]{8}" required>
    </div>

    <div class="form-group">
      <label class="required" for="telefono">Teléfono</label>
      <input type="tel" id="telefono" name="telefono" required>
    </div>

    <div class="form-group">
      <label for="telefonoAlternativo">Teléfono Alternativo</label>
      <input type="tel" id="telefonoAlternativo" name="telefonoAlternativo">
    </div>

    <div class="form-group">
      <label class="required" for="correo">Correo Electrónico</label>
      <input type="email" id="correo" name="correo" required>
    </div>

    <div class="form-group">
      <label for="correoAlternativo">Correo Alternativo</label>
      <input type="email" id="correoAlternativo" name="correoAlternativo">
    </div>

    <div class="form-group">
      <label class="required" for="region">Región</label>
      <select id="region" name="region" required>
        <option value="">Seleccione...</option>
        <option value="Lima">Lima</option>
        <option value="Arequipa">Arequipa</option>
        <option value="Cusco">Cusco</option>
        <option value="La Libertad">La Libertad</option>
        <option value="Piura">Piura</option>
        <option value="Otro">Otro</option>
      </select>
    </div>

    <div class="form-group">
      <label for="fichaPostulante">Ficha de Postulante (PDF)</label>
      <input type="file" id="fichaPostulante" name="fichaPostulante" accept=".pdf">
    </div>

    <div class="form-group">
      <label for="fichaInvencion">Ficha de Invención (PDF)</label>
      <input type="file" id="fichaInvencion" name="fichaInvencion" accept=".pdf">
    </div>

    <div class="form-group">
      <label for="actaCompromiso">Acta de Compromiso (PDF)</label>
      <input type="file" id="actaCompromiso" name="actaCompromiso" accept=".pdf">
    </div>

    <div class="loader" id="loader">
      <p>Enviando formulario, por favor espere...</p>
    </div>

    <button type="submit" class="btn-submit" id="btnSubmit">Enviar Formulario</button>
  </form>

  <div class="mensaje" id="mensaje"></div>
</div>

<script>
(function() {
  // URL del Web App de Google Apps Script (reemplazar con tu URL)
  const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx0nt88YZ2qo6Tw0m211rXnVJXiXxm2iJK05AkyJ7EglLtMJg51dUY1qOklt1tp0KwS/exec';

  const form = document.getElementById('formConcurso');
  const mensaje = document.getElementById('mensaje');
  const loader = document.getElementById('loader');
  const btnSubmit = document.getElementById('btnSubmit');

  // Convertir archivo a Base64
  function fileToBase64(file) {
    return new Promise((resolve, reject) => {
      if (!file) {
        resolve({ base64: '', nombre: '' });
        return;
      }
      const reader = new FileReader();
      reader.readAsDataURL(file);
      reader.onload = () => resolve({ base64: reader.result, nombre: file.name });
      reader.onerror = error => reject(error);
    });
  }

  // Mostrar mensaje
  function mostrarMensaje(texto, tipo) {
    mensaje.textContent = texto;
    mensaje.className = 'mensaje ' + tipo;
    mensaje.style.display = 'block';
  }

  // Manejar envío del formulario
  form.addEventListener('submit', async function(e) {
    e.preventDefault();

    btnSubmit.disabled = true;
    loader.style.display = 'block';
    mensaje.style.display = 'none';

    try {
      // Obtener archivos
      const fichaPostulanteFile = document.getElementById('fichaPostulante').files[0];
      const fichaInvencionFile = document.getElementById('fichaInvencion').files[0];
      const actaCompromisoFile = document.getElementById('actaCompromiso').files[0];

      // Convertir archivos a Base64
      const [fichaPostulante, fichaInvencion, actaCompromiso] = await Promise.all([
        fileToBase64(fichaPostulanteFile),
        fileToBase64(fichaInvencionFile),
        fileToBase64(actaCompromisoFile)
      ]);

      // Construir objeto de datos
      const datos = {
        tipoParticipante: document.getElementById('tipoParticipante').value,
        nombreInstitucionEmpresa: document.getElementById('nombreInstitucionEmpresa').value,
        titulo: document.getElementById('titulo').value,
        sectorTecnologico: document.getElementById('sectorTecnologico').value,
        apellidosRepresentante: document.getElementById('apellidosRepresentante').value,
        nombreRepresentante: document.getElementById('nombreRepresentante').value,
        dni: document.getElementById('dni').value,
        telefono: document.getElementById('telefono').value,
        telefonoAlternativo: document.getElementById('telefonoAlternativo').value,
        correo: document.getElementById('correo').value,
        correoAlternativo: document.getElementById('correoAlternativo').value,
        region: document.getElementById('region').value,
        fichaPostulanteBase64: fichaPostulante.base64,
        fichaPostulanteNombreArchivo: fichaPostulante.nombre,
        fichaInvencionBase64: fichaInvencion.base64,
        fichaInvencionNombreArchivo: fichaInvencion.nombre,
        actaCompromisoBase64: actaCompromiso.base64,
        actaCompromisoNombreArchivo: actaCompromiso.nombre
      };

      // Enviar datos al Apps Script
      const response = await fetch(SCRIPT_URL, {
        method: 'POST',
        mode: 'no-cors',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(datos)
      });

      // Con no-cors no podemos leer la respuesta, asumimos éxito
      mostrarMensaje('¡Formulario enviado exitosamente! Gracias por su participación.', 'exito');
      form.reset();

    } catch (error) {
      console.error('Error:', error);
      mostrarMensaje('Error al enviar el formulario: ' + error.message, 'error');
    } finally {
      btnSubmit.disabled = false;
      loader.style.display = 'none';
    }
  });
})();
</script>



</body>
</html>
